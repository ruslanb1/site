/*!
* © by Sitsanlis Ilias
* This notice shall be included in all copies or substantial portions of the Software.
* Creative Commons 4.0/CC BY - NC - SA 4.0. 
*/
function rnd(e,t){return Math.floor(Math.random()*(t-e+1))+e}function toExp(e){for(var t=e.toExponential(1),a=t.indexOf("e"),r=t.substr(0,a),n=t.substr(a+2),i="",o=t.substr(a+1,1),s=0;s<=n.length-1;s++){var h=n.substr(s,1);if("0"==h)return r;i+="1"==h?"¹":"2"==h?"²":"3"==h?"³":String.fromCharCode("0x207"+h)}return r+"·10"+("-"==o?"⁻":"")+i}function sngNumber(e){var t=e<=0?e.toString():"+"+e.toString();return t}function makeDragLine(e,t,a){null==e&&(e="#000000"),null==t&&(t="dragPoint"),null==a&&(a=100);var r=new createjs.Shape,n=r.graphics;return n.setStrokeStyle(2),n.beginStroke(e),n.mt(0,0).lt(0,a),n.endStroke(),n.endFill(),r.hitArea=new createjs.Shape,r.hitArea.graphics.setStrokeStyle(2),r.hitArea.graphics.beginStroke("#FFFFFF"),r.hitArea.graphics.beginFill("#FFFFFF"),r.hitArea.graphics.dr(-20,0,40,a),r.hitArea.graphics.endFill(),r.hitArea.graphics.endStroke(),r.hitArea.alpha=.1,r.name=t,r}function makeDragPoint(e,t,a){null==e&&(e="#000000"),null==t&&(t="dragPoint"),null==a&&(a=5);var r=new createjs.Shape,n=r.graphics;return n.setStrokeStyle(1),n.beginStroke(e),n.beginFill(e),n.dc(0,0,a),n.endStroke(),n.endFill(),r.hitArea=new createjs.Shape,r.hitArea.graphics.beginStroke("#FFFFFF"),r.hitArea.graphics.beginFill("#FFFFFF"),r.hitArea.graphics.dc(0,0,20),r.hitArea.graphics.endStroke(),r.hitArea.alpha=.01,r.name=t,r}function makePoint(e,t,a){null==e&&(e="#000000"),null==t&&(t="dragPoint"),null==a&&(a=5);var r=new createjs.Shape,n=r.graphics;return n.setStrokeStyle(1),n.beginStroke(e),n.beginFill(e),n.dc(0,0,a),n.endStroke(),n.endFill(),r.name=t,r}function createVector(e,t,a){null==e&&(e="#000000"),null==t&&(t=!1),null==a&&(a=!1);var r=new createjs.Container,n=new createjs.Shape,n=createLineVector(e);r.addChild(n);var i,o,s=new createjs.Shape,s=createArrowVector(e);return r.addChild(s),t&&(new createjs.Shape,i=createDragLineVector(),r.addChild(i)),a&&(new createjs.Shape,o=createCircleVector(e),r.addChild(o)),r}function createLineVector(e){null==e&&(e="#000000");var t=new createjs.Shape,a=t.graphics;return a.setStrokeStyle(2),a.beginStroke(e),a.moveTo(0,0),a.lineTo(100,0),a.endStroke(),t}function createDragLineVector(){var e=new createjs.Shape,t=e.graphics;return t.setStrokeStyle(25),t.beginStroke("#ffffff"),t.moveTo(0,0),t.lineTo(100,0),t.endStroke(),e.alpha=.01,e.name="dragLine",e}function createCircleVector(e){null==e&&(e="#000000");var t=new createjs.Shape,a=t.graphics;return a.beginFill("#000000"),a.dc(0,0,2),t.name="startVector",t}function createArrowVector(e){null==e&&(e="#000000");var t=new createjs.Shape,a=t.graphics;return a.setStrokeStyle(1.5,"round","round"),a.beginStroke(e),a.beginFill(e),a.moveTo(0,0),a.lineTo(8*Math.cos(155*toRad),-8*Math.sin(155*toRad)),a.lineTo(-5.5,0),a.lineTo(8*Math.cos(205*toRad),-8*Math.sin(205*toRad)),a.closePath(),a.endFill(),a.endStroke(),t}function updateTextVector(e,t,a,r){var n=t.rotation;arrowVec=t.getChildAt(1);var i=arrowVec.x;i<0&&(i=Math.abs(i),n+=180);var o=(i=Math.abs(i))*Math.cos(n*toRad),s=i*Math.sin(n*toRad),h=t.x+o+a*Math.cos(n*toRad)+r*Math.cos((n+90)*toRad),c=t.y+s+a*Math.sin(n*toRad)+r*Math.sin((n+90)*toRad);e.x=h,e.y=c,e.textBaseline="alphabetic",e.textAlign="center",Math.abs(i)<5?e.alpha=0:e.alpha=1}function mouseDownVector(e){var t=canvas.width,a=canvas.height;e.target.offset={x:e.target.x-e.stageX*(720/t),y:e.target.y-e.stageY*(420/a)},e.target.addEventListener("pressmove",pressMoveVector)}function pressMoveVector(e){var t=canvas.width,a=canvas.height,r=e.stageX*(720/t)+e.target.offset.x,n=e.stageY*(420/a)+e.target.offset.y;e.target.x=r,e.target.y=n,stage.update()}function pressUpVector(e){e.target.removeEventListener("pressmove",pressMoveVector)}function fixPeriod(e,t){return e-t*Math.floor(e/t)}createjs.Container.prototype.setScaleX=function(e){var t=this.getChildAt(0),a=this.getChildAt(1),r=this.getChildByName("dragLine"),n=(this.getChildByName("startVector"),(a.x=e)<0?-1:1);25<=Math.abs(e)?(a.scaleX=n,t.scaleX=(e-n)/100,null!=r&&(r.scaleX=(e-n)/100)):(a.scaleX=4*e/100,t.scaleX=e/100-4*e/100/100,null!=r&&(r.scaleX=e/100-4*e/100/100))};var shifted=!(createjs.Shape.prototype.drawDistance=function(e,t,a,r,n,i){null==e&&(e="#000000");var o=this.graphics;o.clear();var s,h=Math.sqrt((r-t)*(r-t)+(n-a)*(n-a)),c=Math.atan2(-(n-a),r-t);2<h&&(s=8*(25<h?1:4*h/100),o.setStrokeStyle(1,"round","round"),o.beginStroke(e),o.mt(s*Math.cos(25*toRad),-s*Math.sin(25*toRad)).lt(0,0).lt(s*Math.cos(25*toRad),s*Math.sin(25*toRad)),o.mt(0,0).lt(h,0).lt(h+s*Math.cos(155*toRad),-s*Math.sin(155*toRad)).mt(h,0).lt(h+s*Math.cos(205*toRad),-s*Math.sin(205*toRad)),o.setStrokeStyle(1),o.setStrokeDash([2,2],2),o.beginStroke(e),o.mt(0,i/2).lt(0,-i/2),o.mt(h,i/2).lt(h,-i/2),o.endStroke(),o.beginFill("#FFFFFF"),o.dr(h/2-20,-6,40,12),this.rotation=-c*toDeg,this.regX=i*Math.cos(Math.PI/2),this.regY=-i*Math.sin(Math.PI/2),this.x=t,this.y=a)});$(document).on("keyup keydown",function(e){shifted=e.shiftKey}),createjs.Container.prototype.slider=function(o){var e=new createjs.Shape,a=e.graphics;this.addChild(e);canvas.width,canvas.height;a.setStrokeStyle(1),a.beginStroke("#aaa");for(var r=o/12,n=0;n<=12;n++)a.mt(n*r,-2).lt(n*r,-6);a.beginFill("#eee"),a.r(0,-2,o,4),a.endFill(),e.hitArea=new createjs.Shape,e.hitArea.graphics.beginStroke("#FFFFFF"),e.hitArea.graphics.beginFill("#FFFFFF"),e.hitArea.graphics.r(0,-10,o,20),e.hitArea.graphics.endStroke(),e.hitArea.alpha=.01;var i=new createjs.Shape;this.addChild(i),(a=i.graphics).setStrokeStyle(1),a.beginStroke("#aaa"),a.beginFill("#eee"),a.r(-4,-4,8,8),i.hitArea=new createjs.Shape,i.hitArea.graphics.beginStroke("#FFFFFF"),i.hitArea.graphics.beginFill("#FFFFFF"),i.hitArea.graphics.dc(0,0,20),i.hitArea.graphics.endStroke(),i.hitArea.alpha=.01;for(var s,n=0;n<=4;n++){0==n?s=new createjs.Text("0","10px Trebuchet MS","#666666"):1==n?s=new createjs.Text("T/4","10px Trebuchet MS","#666666"):2==n?s=new createjs.Text("T/2","10px Trebuchet MS","#666666"):3==n?s=new createjs.Text("3T/4","10px Trebuchet MS","#666666"):4==n&&(s=new createjs.Text("T","10px Trebuchet MS","#666666")),s.set({textAlign:"center"}),s.x=n*o/4,s.y=-18,this.addChild(s)}function h(e){var a=canvas.width,r=canvas.height,n=e.stageX*(720/a)+e.target.offset.x;e.stageY,e.target.offset.y;n<0&&(n=0),o<n&&(n=o),t=T*(e.target.kT+n/o),calculations(),positions()}e.on("click",function(e){var a,r,n,i;!isNaN(T)&&isFinite(T)&&(a=canvas.width,r=Math.floor(t/T),t=T*(r+(e.stageX*(720/a)-160)/o),n=T/12,i=t-T*r,Math.abs(i-n*Math.round(i/n))<=.05&&(t=T*r+Math.round(i/n)*n),calculations(),positions())}),i.on("mousedown",function(e){var a,r;!isNaN(T)&&isFinite(T)&&(a=canvas.width,r=canvas.height,e.target.offset={x:e.target.x-e.stageX*(720/a),y:e.target.y-e.stageY*(420/r)},e.target.addEventListener("pressmove",h),e.target.kT=Math.floor(t/T))}),i.on("pressup",function(e){var a,r,n;!isNaN(T)&&isFinite(T)&&(e.target.x==o&&(e.target.x=0),shifted||(a=T/12,r=t-T*e.target.kT,n=Math.abs(r-a*Math.round(r/a)),Math.abs(t-T*Math.round(t/T))<1e-10?t=T*Math.round(t/T)+1e-10:n<=a/2&&(t=a*Math.round(t/a))),calculations(),positions(),e.target.removeEventListener("pressmove",h))})},createjs.Shape.prototype.addArrow=function(e,t,a,r){var n=this.graphics;n.ss(1),n.s(e),n.mt(t,a).lt(t+6*Math.cos((145+r)*toRad),a-6*Math.sin((145+r)*toRad)).mt(t,a).lt(t+6*Math.cos((215+r)*toRad),a-6*Math.sin((215+r)*toRad))};