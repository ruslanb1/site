


function mouseDownGen(t){var e=canvas.width,a=canvas.height;_xmouse=t.stageX*(720/e),_ymouse=t.stageY*(420/a),restart(),t.target.addEventListener("pressmove",pressMoveGen)}function pressMoveGen(t){var e=canvas.width,a=canvas.height;_xmouse=t.stageX*(720/e),_ymouse=t.stageY*(420/a),playMovie=!0,forceIsAct=!0,positions()}function pressUpGen(t){forceIsAct=!1,playMovie=!1;var e=xPos[xPos.length-1]-xPos[0],a=yPos[yPos.length-1]-yPos[0];drFinal=Math.sqrt(e*e+a*a)*xScale;var r=Math.atan2(a,e)*toDeg;drVec.rotation=-r,valuesText.text=sText+", Перемещение = "+(drFinal/xScale).toFixed(1)+" м, θ = "+r.toFixed(1)+" "+moires,positions(),t.target.removeEventListener("pressmove",pressMoveGen)}function mouseDownRuler(t){var e=canvas.width,a=canvas.height;t.target.offset={x:t.target.parent.x-t.stageX*(720/e),y:t.target.parent.y-t.stageY*(420/a)},t.target.addEventListener("pressmove",pressMoveRuler),t.target.oldRotation=t.target.parent.rotation,t.target.φi=Math.atan2(-t.target.offset.y,-t.target.offset.x)*toDeg,t.target.oldMouse={x:t.stageX*(720/e),y:t.stageY*(420/a)},t.target.oldPos={x:t.target.x,y:t.target.y},t.target.parentOldPos={x:t.target.parent.x,y:t.target.parent.y},t.target.parentOldReg={x:t.target.parent.regX,y:t.target.parent.regY}}function pressMoveRuler(t){var e,a,r,o,g,s=canvas.width,n=canvas.height,p=t.stageX*(720/s)+t.target.offset.x,d=t.stageY*(420/n)+t.target.offset.y;"rotator"==t.target.name?(r=t.stageX*(720/s)-t.target.parent.x,o=t.stageY*(420/n)-t.target.parent.y,e=Math.atan2(o,r)*toDeg-t.target.φi,a=t.target.oldRotation+e,Math.abs(a)<2&&(a=0),Math.abs(Math.abs(a)-180)<2&&(a=180*Math.round(a/180)),Math.abs(Math.abs(a)-90)<2&&(a=90*Math.round(a/90)),Math.abs(Math.abs(a)-270)<2&&(a=270*Math.round(a/270)),t.target.parent.rotation=a):"rotationPoint"==t.target.name?(r=t.stageX*(720/s)-t.target.oldMouse.x,o=t.stageY*(420/n)-t.target.oldMouse.y,g=convertPositions(r,o,-t.target.oldRotation*toRad),r=Math.round(g.x/xScale)*xScale,o=12.5*Math.round(g.y/12.5),t.target.parentOldReg.x+r<0&&(r=-t.target.parentOldReg.x),t.target.parentOldReg.x+r>12*xScale&&(r=12*xScale-t.target.parentOldReg.x),t.target.parentOldReg.y+o<0&&(o=-t.target.parentOldReg.y),25<t.target.parentOldReg.y+o&&(o=25-t.target.parentOldReg.y),newRegX=t.target.parentOldReg.x+r,newRegY=t.target.parentOldReg.y+o,t.target.parent.regX=newRegX,t.target.parent.regY=newRegY,t.target.x=t.target.oldPos.x+r,t.target.y=t.target.oldPos.y+o,g=convertPositions(r,o,t.target.oldRotation*toRad),t.target.parent.x=t.target.parentOldPos.x+g.x,t.target.parent.y=t.target.parentOldPos.y+g.y):(t.target.parent.x=p,t.target.parent.y=d),stage.update()}function pressUpRuler(t){t.target.removeEventListener("pressmove",pressMoveRuler)}