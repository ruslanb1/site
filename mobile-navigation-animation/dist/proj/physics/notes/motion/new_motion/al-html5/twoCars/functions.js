function rnd(e,t){return Math.floor(Math.random()*(t-e+1))+e}function toExp(e){for(var t=e.toExponential(1),a=t.indexOf("e"),r=t.substr(0,a),s=t.substr(a+2),i="",n=t.substr(a+1,1),h=0;h<=s.length-1;h++){var o=s.substr(h,1);if("0"==o)return r;i+="1"==o?"¹":"2"==o?"²":"3"==o?"³":String.fromCharCode("0x207"+o)}return r+"·10"+("-"==n?"⁻":"")+i}function sngNumber(e){return e<=0?e.toString():"+"+e.toString()}function makeDragLine(e,t,a){null==e&&(e="#000000"),null==t&&(t="dragPoint"),null==a&&(a=100);var r=new createjs.Shape,s=r.graphics;return s.setStrokeStyle(2),s.beginStroke(e),s.mt(0,0).lt(0,a),s.endStroke(),s.endFill(),r.hitArea=new createjs.Shape,r.hitArea.graphics.setStrokeStyle(2),r.hitArea.graphics.beginStroke("#FFFFFF"),r.hitArea.graphics.beginFill("#FFFFFF"),r.hitArea.graphics.dr(-20,0,40,a),r.hitArea.graphics.endFill(),r.hitArea.graphics.endStroke(),r.hitArea.alpha=.1,r.name=t,r}function makeDragPoint(e,t,a){null==e&&(e="#000000"),null==t&&(t="dragPoint"),null==a&&(a=5);var r=new createjs.Shape,s=r.graphics;return s.setStrokeStyle(1),s.beginStroke("#000000"),s.beginFill(e),s.dc(0,0,a),s.endStroke(),s.endFill(),r.hitArea=new createjs.Shape,r.hitArea.graphics.beginStroke("#FFFFFF"),r.hitArea.graphics.beginFill("#FFFFFF"),r.hitArea.graphics.dc(0,0,15),r.hitArea.graphics.endStroke(),r.hitArea.alpha=.01,r.name=t,r}function makePoint(e,t,a){null==e&&(e="#000000"),null==t&&(t="dragPoint"),null==a&&(a=5);var r=new createjs.Shape,s=r.graphics;return s.setStrokeStyle(1),s.beginStroke(e),s.beginFill(e),s.dc(0,0,a),s.endStroke(),s.endFill(),r.name=t,r}function createVector(e,t,a){null==e&&(e="#000000"),null==t&&(t=!1),null==a&&(a=!1);var r=new createjs.Container,s=new createjs.Shape;s=createLineVector(e),r.addChild(s);var i=new createjs.Shape;if(i=createArrowVector(e),r.addChild(i),t){var n=new createjs.Shape;n=createDragLineVector(),r.addChild(n)}if(a){var h=new createjs.Shape;h=createCircleVector(e),r.addChild(h)}return r}function createLineVector(e){null==e&&(e="#000000");var t=new createjs.Shape,a=t.graphics;return a.setStrokeStyle(2.5),a.beginStroke(e),a.moveTo(0,0),a.lineTo(100,0),a.endStroke(),t}function createDragLineVector(){var e=new createjs.Shape,t=e.graphics;return t.setStrokeStyle(15),t.beginStroke("#ffffff"),t.moveTo(0,0),t.lineTo(100,0),t.endStroke(),e.alpha=.01,e.name="dragLine",e}function createCircleVector(e){null==e&&(e="#000000");var t=new createjs.Shape,a=t.graphics;return a.beginFill("#000000"),a.dc(0,0,3),t.name="startVector",t}function createArrowVector(e){null==e&&(e="#000000");var t=new createjs.Shape,a=t.graphics;return a.setStrokeStyle(1.5,"round","round"),a.beginStroke(e),a.beginFill(e),a.moveTo(0,0),a.lineTo(8*Math.cos(155*toRad),-8*Math.sin(155*toRad)),a.lineTo(-5.5,0),a.lineTo(8*Math.cos(205*toRad),-8*Math.sin(205*toRad)),a.closePath(),a.endFill(),a.endStroke(),t}function updateTextVector(e,t,a,r){var s=t.rotation;arrowVec=t.getChildAt(1),(i=arrowVec.x)<0&&(i=Math.abs(i),s+=180);var i,n=(i=Math.abs(i))*Math.cos(s*toRad),h=i*Math.sin(s*toRad),o=t.x+n+a*Math.cos(s*toRad)+r*Math.cos((s+90)*toRad),c=t.y+h+a*Math.sin(s*toRad)+r*Math.sin((s+90)*toRad);e.x=o,e.y=c,e.textBaseline="alphabetic",e.textAlign="center",Math.abs(i)<5?e.alpha=0:e.alpha=1}function mouseDownVector(e){var t=canvas.width,a=canvas.height;e.target.offset={x:e.target.x-e.stageX*(720/t),y:e.target.y-e.stageY*(420/a)},e.target.addEventListener("pressmove",pressMoveVector)}function pressMoveVector(e){var t=canvas.width,a=(canvas.height,e.target.index);"vVec"==e.target.name?(vi[a]=Number((e.stageX*(720/t)-e.target.x)/(vScale*vectorScale)),xi[a]=x[a]):"aVec"==e.target.name&&(ai[a]=Number((e.stageX*(720/t)-e.target.x)/(aScale*vectorScale)),xi[a]=x[a]),restart(),stage.update()}function pressUpVector(e){e.target.removeEventListener("pressmove",pressMoveVector);var t=e.target.index,a=.2*yAxisV.step;vi[t]=Math.round(vi[t]/a)*a,ai[t]=.1*Math.round(ai[t]/.1),restart()}function fixPeriod(e,t){return e-t*Math.floor(e/t)}createjs.Container.prototype.setScaleX=function(e){var t,a=this.getChildAt(0),r=this.getChildAt(1),s=this.getChildByName("dragLine");this.getChildByName("startVector");t=(r.x=e)<0?-1:1,25<=Math.abs(e)?(r.scaleX=t,a.scaleX=(e-t)/100,null!=s&&(s.scaleX=(e-t)/100)):(r.scaleX=4*e/100,a.scaleX=e/100-4*e/100/100,null!=s&&(s.scaleX=e/100-4*e/100/100))};var shifted=!(createjs.Shape.prototype.drawDistance=function(e,t,a,r,s,i){null==e&&(e="#000000");var n=this.graphics;n.clear();var h=Math.sqrt((r-t)*(r-t)+(s-a)*(s-a)),o=Math.atan2(-(s-a),r-t);if(2<h){var c=8*(25<h?1:4*h/100);n.setStrokeStyle(1,"round","round"),n.beginStroke(e),n.mt(c*Math.cos(25*toRad),-c*Math.sin(25*toRad)).lt(0,0).lt(c*Math.cos(25*toRad),c*Math.sin(25*toRad)),n.mt(0,0).lt(h,0).lt(h+c*Math.cos(155*toRad),-c*Math.sin(155*toRad)).mt(h,0).lt(h+c*Math.cos(205*toRad),-c*Math.sin(205*toRad)),n.setStrokeStyle(1),n.setStrokeDash([2,2],2),n.beginStroke(e),n.mt(0,i/2).lt(0,-i/2),n.mt(h,i/2).lt(h,-i/2),n.endStroke(),n.beginFill("#FFFFFF"),n.dr(h/2-20,-6,40,12),this.rotation=-o*toDeg,this.regX=i*Math.cos(Math.PI/2),this.regY=-i*Math.sin(Math.PI/2),this.x=t,this.y=a}});$(document).on("keyup keydown",function(e){shifted=e.shiftKey}),createjs.Container.prototype.slider=function(i){var e=new createjs.Shape,t=e.graphics;this.addChild(e);canvas.width,canvas.height;t.setStrokeStyle(1),t.beginStroke("#aaa");for(var a=i/10,r=0;r<=10;r++)t.mt(r*a,-2).lt(r*a,-6);t.beginFill("#eee"),t.r(0,-2,i,4),t.endFill(),e.hitArea=new createjs.Shape,e.hitArea.graphics.beginStroke("#FFFFFF"),e.hitArea.graphics.beginFill("#FFFFFF"),e.hitArea.graphics.r(0,-10,i,20),e.hitArea.graphics.endStroke(),e.hitArea.alpha=.01;var s=new createjs.Shape;this.addChild(s),(t=s.graphics).setStrokeStyle(1),t.beginStroke("#aaa"),t.beginFill("#eee"),t.r(-6,-6,12,12),s.hitArea=new createjs.Shape,s.hitArea.graphics.beginStroke("#FFFFFF"),s.hitArea.graphics.beginFill("#FFFFFF"),s.hitArea.graphics.dc(0,0,20),s.hitArea.graphics.endStroke(),s.hitArea.alpha=.01;var n=new createjs.Text("","10px Trebuchet MS","#666666");function h(e){var t=canvas.width,a=canvas.height,r=e.stageX*(720/t)+e.target.offset.x;e.stageY,e.target.offset.y;r<0&&(r=0),i<r&&(r=i),e.target.x=r;var s=Math.round(10*Math.pow(10,r/(i/2)-1))/10;dtSlow=dtInitial*s,dt=dtSlow,stage.update()}n.set({textAlign:"center"}),n.x=i/2,n.y=-20,this.addChild(n),s.on("mousedown",function(e){var t=canvas.width,a=canvas.height;e.target.offset={x:e.target.x-e.stageX*(720/t),y:e.target.y-e.stageY*(420/a)},e.target.addEventListener("pressmove",h)})},createjs.Shape.prototype.addArrow=function(e,t,a,r){var s=this.graphics;s.ss(1),s.s(e),s.mt(t,a).lt(t+7*Math.cos((152.5+r)*toRad),a-7*Math.sin((152.5+r)*toRad)).mt(t,a).lt(t+7*Math.cos((207.5+r)*toRad),a-7*Math.sin((207.5+r)*toRad))},createjs.Container.prototype.xAxisCreate=function(e,t,a){var r=Math.abs((t-e)/15).toExponential(1),s=r.indexOf("e"),i=Number(r.substr(0,s)),n=Number(r.substr(s+1));if(i<2)var h=Number("1e"+n);else if(i<5)h=Number("2e"+n);else h=Number("5e"+n);var o=0;h<1&&(o=1),this.step=h;var c="#666";this.removeAllChildren(),this.set({x:X0,y:0});var l=new createjs.Shape;l.graphics.f("#fff").r(-this.x,-7.5,720,25),this.addChild(l);var d=new createjs.Shape;d.graphics.ss(1.5).s(c).mt(-this.x,0).lt(720-this.x,0),d.addArrow(c,720-this.x,0,0),d.graphics.f("#666").s("#666").ss(2).dc(0,0,1.5),d.graphics.s(c).ss(1);for(var g=0;g<=t;g+=h){if(0!=g&&d.graphics.mt(g*a,0).lt(g*a,5),g<=t-.5*h)for(var p=.2*h;p<h;p+=.2*h)d.graphics.mt((g+(g<0?-1:1)*p)*a,0).lt((g+(g<0?-1:1)*p)*a,3);(u=new createjs.Text(g.toFixed(o),"9px Trebuchet MS",c)).set({textAlign:"center"}),u.x=g*a,u.y=-11,this.addChild(u)}for(g=0;e<=g;g-=h){if(0!=g&&d.graphics.mt(g*a,0).lt(g*a,5),e<=g)for(p=.2*h;p<h;p+=.2*h)d.graphics.mt((g-p)*a,0).lt((g-p)*a,3);var u;(u=new createjs.Text(g.toFixed(o),"9px Trebuchet MS",c)).set({textAlign:"center"}),u.x=g*a,u.y=-11,this.addChild(u)}this.addChild(d)},createjs.Container.prototype.tAxisCreate=function(e,t){var a=Math.abs(e/4).toExponential(1),r=a.indexOf("e"),s=Number(a.substr(0,r)),i=Number(a.substr(r+1));if(s<2)var n=Number("1e"+i);else if(s<5)n=Number("2e"+i);else n=Number("5e"+i);var h=0;n<1&&(h=1),this.step=n;var o="#666";this.removeAllChildren();var c=new createjs.Shape;c.alpha=.8,this.addChild(c),c.hitArea=new createjs.Shape,c.hitArea.alpha=.01,c.hitArea.graphics.f("#000").r(0,-10,Lpx+10,20),c.graphics.s(o).ss(1),c.graphics.ss(.5).s("#E9E9E9");for(var l=n;l<=e;l+=n){gridFlag&&c.graphics.ss(1).s("#9B9995").mt(l*t,-2*Hpx).lt(l*t,2*Hpx),c.graphics.ss(1).s(o).mt(l*t,0).lt(l*t,5);var d=new createjs.Text(l.toFixed(h),"9px Trebuchet MS","#333");d.set({textAlign:"center"}),d.x=l*t,d.y=8,this.addChild(d)}for(l=0;l<=e;l+=n)for(var g=.2*n;g<n;g+=.2*n)l+g<e&&(gridFlag&&c.graphics.ss(.5).s("#9B9995").mt((l+g)*t,-2*Hpx).lt((l+g)*t,2*Hpx),c.graphics.ss(1).s(o).mt((l+g)*t,0).lt((l+g)*t,3));c.graphics.ss(1.5).s(o).mt(0,0).lt(Lpx+10,0).f(o).dc(0,0,2),c.addArrow(o,Lpx+10,0,0)},createjs.Container.prototype.yAxisCreate=function(e,t,a){var r=Math.abs((t-e)/4.5).toExponential(1),s=r.indexOf("e"),i=Number(r.substr(0,s)),n=Number(r.substr(s+1));if(i<2)var h=Number("1e"+n);else if(i<5)h=Number("2e"+n);else h=Number("5e"+n);var o=0;h<1&&(o=1),this.step=h;var c="#666";this.removeAllChildren();var l=new createjs.Shape;l.graphics.ss(1.5).s(c).mt(0,e*a).lt(0,t*a-10),l.alpha=.8;for(var d=0;d<=t;d+=h){0!=d&&(l.graphics.ss(1).s(c).mt(-5,d*a).lt(0,d*a),gridFlag&&l.graphics.ss(1).s("#9B9995").mt(0,d*a).lt(Lpx,d*a)),(g=new createjs.Text(d.toFixed(o),"9px Trebuchet MS","#333")).set({textAlign:"right"}),g.y=d*a-4,g.x=-8,this.addChild(g)}for(d=-h;e<=d;d-=h){var g;l.graphics.ss(1).s(c).mt(-5,d*a).lt(0,d*a),gridFlag&&l.graphics.ss(1).s("#9B9995").mt(0,d*a).lt(Lpx,d*a),(g=new createjs.Text(d.toFixed(o),"9px Trebuchet MS","#333")).set({textAlign:"right"}),g.y=d*a-4,g.x=-8,this.addChild(g)}l.graphics.ss(.5).s("#E9E9E9");for(d=0;d<=t;d+=h)for(var p=.2*h;p<h;p+=.2*h)d+p<t&&(l.graphics.ss(1).s(c).mt(-3,(d+p)*a).lt(0,(d+p)*a),gridFlag&&l.graphics.ss(.5).s("#E9E9E9").mt(0,(d+p)*a).lt(Lpx,(d+p)*a));for(d=0;e<=d;d-=h)if(e<=d)for(p=.2*h;p<h;p+=.2*h)e<d-p&&(l.graphics.ss(1).s(c).mt(-3,(d-p)*a).lt(0,(d-p)*a),gridFlag&&l.graphics.ss(.5).s("#E9E9E9").mt(0,(d-p)*a).lt(Lpx,(d-p)*a));l.addArrow(c,0,t*a-10,90),l.graphics.s(c).ss(1),this.addChild(l)};